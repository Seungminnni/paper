# μλ£ λ°μ΄ν„° κΈ°λ° ν”„λΌμ΄λ²„μ‹ λ³΄νΈ μ—°κµ¬
## Medical Data Privacy Protection Research using BERT

μ΄ ν”„λ΅μ νΈλ” ν™μ λ°μ΄ν„°λ¥Ό ν™μ©ν• BERT κΈ°λ° κ°μ—Ό μμΈ΅ λ¨λΈμ„ κ°λ°ν•κ³ , μν™ μ€ν κΈ°λ²•μΌλ΅ ν”„λΌμ΄λ²„μ‹λ¥Ό λ³΄νΈν•λ” μ—°κµ¬μ…λ‹λ‹¤.

## π“‹ νμΌ κµ¬μ΅°

```
β”β”€β”€ pre_train.py           # BERT λ¨λΈ ν”„λ¦¬ νΈλ μ΄λ‹
β”β”€β”€ fine_tune.py           # λ¨λΈ νμΈνλ‹
β”β”€β”€ server_side.py         # μ„λ²„ μ‚¬μ΄λ“ Smashed Data μƒμ„± (500κ° μƒν”)
β”β”€β”€ client_side.py         # ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ Smashed Data μƒμ„± (300κ° μƒν”)
β”β”€β”€ run_all.sh            # μ „μ²΄ νμ΄ν”„λΌμΈ λ°°μΉ μ‹¤ν–‰
β”β”€β”€ requirements.txt       # ν•„μ”ν• ν¨ν‚¤μ§€ λ©λ΅
β””β”€β”€ README.md             # μ΄ νμΌ
```

## π€ μ‚¬μ© λ°©λ²•

### 1. ν™κ²½ μ„¤μ •

```bash
# κ°€μƒν™κ²½ ν™μ„±ν™” (μ΄λ―Έ ν™μ„±ν™”λμ–΄ μλ‹¤κ³  κ°€μ •)
source .venv/bin/activate

# ν¨ν‚¤μ§€ μ„¤μΉ
pip install -r requirements.txt
```

### 2. λ°μ΄ν„° μ¤€λΉ„

λ‹¤μ CSV νμΌλ“¤μ΄ ν•„μ”ν•©λ‹λ‹¤:
- `output1.csv`: ν™μ κΈ°λ³Έ μ •λ³΄
- `output3.csv`: μ¶”κ°€ ν™μ λ°μ΄ν„°
- `infected.csv`: κ°μ—Ό μƒνƒ λ μ΄λΈ”
- `random_500.csv`: 500κ° μƒν” λ°μ΄ν„° (μ„λ²„μ©)
- `random_300.csv`: 300κ° μƒν” λ°μ΄ν„° (ν΄λΌμ΄μ–ΈνΈμ©)

### 3. μ‹¤ν–‰ λ°©λ²•

#### κ°λ³„ μ‹¤ν–‰
```bash
# 1. ν”„λ¦¬ νΈλ μ΄λ‹
python pre_train.py

# 2. νμΈνλ‹
python fine_tune.py

# 3. μ„λ²„ μ‚¬μ΄λ“ Smashed Data μƒμ„±
python server_side.py

# 4. ν΄λΌμ΄μ–ΈνΈ μ‚¬μ΄λ“ Smashed Data μƒμ„±
python client_side.py
```

#### μ „μ²΄ νμ΄ν”„λΌμΈ μ‹¤ν–‰
```bash
# λ¨λ“  λ‹¨κ³„λ¥Ό μμ°¨μ μΌλ΅ μ‹¤ν–‰
chmod +x run_all.sh
./run_all.sh
```

## οΏ½ μ—°κµ¬ νμ΄ν”„λΌμΈ

### 1. Pre-training (`pre_train.py`)
- **λ©μ **: BERT λ¨λΈμ„ μλ£ λ°μ΄ν„°μ— λ§κ² ν”„λ¦¬ νΈλ μ΄λ‹
- **μ…λ ¥**: `output1.csv`, `infected.csv`
- **μ¶λ ¥**: `Pre_train_epoch*_BERT_Based.pt`
- **νΉμ§•**:
  - 1000κ° μƒν” μ‚¬μ©
  - 10 μ—ν­ ν•™μµ
  - 8λ²μ§Έ λ μ΄μ–΄ hidden states μ¶”μ¶

### 2. Fine-tuning (`fine_tune.py`)
- **λ©μ **: ν”„λ¦¬ νΈλ μ΄λ‹λ λ¨λΈμ„ μ¶”κ°€ ν•™μµ
- **μ…λ ¥**: `output3.csv`, `infected.csv`, `Pre_train_epoch10_BERT_Based.pt`
- **μ¶λ ¥**: `Fine_tuned_epoch*_BERT_Based.pt`
- **νΉμ§•**:
  - λ‚®μ€ ν•™μµλ¥  (2e-6) μ‚¬μ©
  - 20 μ—ν­ μ¶”κ°€ ν•™μµ

### 3. Server-side Smashed Data (`server_side.py`)
- **λ©μ **: μ„λ²„μ—μ„ Smashed Data μƒμ„±
- **μ…λ ¥**: `random_500.csv`, `infected.csv`, `Fine_tuned_epoch20_BERT_Based.pt`
- **μ¶λ ¥**: `Dictionary_smashed_data_layer2.csv`
- **νΉμ§•**:
  - 500κ° μƒν” μ²λ¦¬
  - 5λ²μ§Έ λ μ΄μ–΄ hidden states μ‚¬μ©

### 4. Client-side Smashed Data (`client_side.py`)
- **λ©μ **: ν΄λΌμ΄μ–ΈνΈμ—μ„ Smashed Data μƒμ„±
- **μ…λ ¥**: `random_300.csv`, `infected.csv`, `Fine_tuned_epoch20_BERT_Based.pt`
- **μ¶λ ¥**: `Client_smashed_data_layer2.csv`
- **νΉμ§•**:
  - 300κ° μƒν” μ²λ¦¬
  - 5λ²μ§Έ λ μ΄μ–΄ hidden states μ‚¬μ©

## π”§ κΈ°μ  μ¤νƒ

- **μ–Έμ–΄**: Python 3.12
- **λ¨Έμ‹ λ¬λ‹**: PyTorch, Transformers
- **λ°μ΄ν„° μ²λ¦¬**: Pandas, NumPy
- **ν•λ“μ›¨μ–΄**: Apple Silicon (MPS μ§€μ›)

## π“ μ£Όμ” μ„±κ³Ό

1. **λ¨λΈ μ„±λ¥**: Pre-training + Fine-tuningμΌλ΅ μ•μ •μ μΈ ν•™μµ
2. **ν”„λΌμ΄λ²„μ‹ λ³΄νΈ**: BERT hidden statesλ¥Ό ν†µν• λ°μ΄ν„° λ³€ν™
3. **λ°μ΄ν„° ν¨μ¨μ„±**: 500κ° μƒν”λ΅ λΉ λ¥Έ μ‹¤ν— κ°€λ¥
4. **μ μ‚¬λ„ λ¶„μ„**: μ ν΄λ¦¬λ“ κ±°λ¦¬ κΈ°λ° μ •ν™•λ„ λ° ν†µκ³„ λ¶„μ„

## π”’ λ³΄μ• λ©”μ»¤λ‹μ¦

- **BERT κΈ°λ° λ³€ν™**: ν…μ¤νΈ λ°μ΄ν„°λ¥Ό 768μ°¨μ› λ²΅ν„°λ΅ λ³€ν™
- **Hidden States μ¶”μ¶**: 5λ²μ§Έ λ μ΄μ–΄μ νΉμ§• λ²΅ν„° μ‚¬μ©
- **μµλ…ν™”**: μ›λ³Έ λ°μ΄ν„°μ™€μ μ—°κ²°μ„± μ κ±°

## οΏ½ μ°Έκ³ μ‚¬ν•­

- Apple Silicon Macμ—μ„ MPSλ¥Ό ν™μ©ν• GPU κ°€μ† μ§€μ›
- κ° λ‹¨κ³„λ§λ‹¤ λ¨λΈμ΄ μ €μ¥λμ–΄ μ¤‘κ°„μ— μ¤‘λ‹¨ν•΄λ„ μ¬μ‹μ‘ κ°€λ¥
- Smashed Dataλ” μ›λ³Έ λ°μ΄ν„°λ¥Ό λ³µμ›ν•  μ μ—†λ” λ°©μ‹μΌλ΅ λ³€ν™

## π― μ—°κµ¬ λ©ν‘ λ‹¬μ„±λ„

- β… **ν™μ λ°μ΄ν„° κΈ°λ° μμΈ΅ λ¨λΈ**: BERT κΈ°λ° κ°μ—Ό λ¶„λ¥ μ„±κ³µ
- β… **μν™ μ€ν ν”„λ μ„μ›ν¬**: Hidden statesλ¥Ό ν†µν• Smashed Data μƒμ„±
- β… **ν”„λΌμ΄λ²„μ‹ λ³΄νΈ**: λ°μ΄ν„° μµλ…ν™” λ° μ μ‚¬λ„ λ¶„μ„ μ™„λ£
- β… **μ‹κ°ν™”**: t-SNEλ¥Ό ν†µν• λ°μ΄ν„° λ¶„ν¬ λ¶„μ„ μ™„λ£

---

**μ—°κµ¬μ**: Seungmin
**λ‚ μ§**: 2025λ…„ 9μ›” 1μΌ
